import{_ as n,a0 as s,a1 as a,a4 as t}from"./framework-786d5328.js";const p={},e=t(`<h1 id="移动端适配" tabindex="-1"><a class="header-anchor" href="#移动端适配" aria-hidden="true">#</a> 移动端适配</h1><p>核心是：<strong>进行屏幕宽度的等比缩放</strong></p><h2 id="rem-适配" tabindex="-1"><a class="header-anchor" href="#rem-适配" aria-hidden="true">#</a> rem 适配</h2><p>场景：设计稿的宽度是 750px，而一般手机设备的宽度是 375px。那么在写代码的时候，如果一个元素在设计稿上的宽度为 100px，那么就要写成 50px。存在一个问题：每次得到一个宽度都需要自己去换算，而且实际设备的宽度也不能确定一定是 375px。所以需要实现不同设备的等比缩放。</p><ul><li>750px 的设计稿=》375px 的设备</li></ul><p>​ 设计稿中 100px 的元素=》设备上 50px</p><ul><li>750px 的设计稿=》250px 的设备</li></ul><p>​ 设计稿中 300px 的元素=》设备上 100px</p><p>现有问题：</p><ul><li><p>如何确定设备的大小？</p></li><li><p>知道了设备的大小（也就是知道了缩放的比例），如何动态的修改代码中的 px 大小？不可能为了多个设备写多份 px 吧。</p></li></ul><p>解决：</p><p>此时就可以用 rem 来实现。</p><p>什么是 rem？rem 是相对单位，它的大小根据根节点的 font-size 属性。例如：根节点的 font-size 是 100px，那么 1rem == 100px</p><p>由于 rem 是根据 font-size 来定的，那么只需要根据不同的设备来给一个初始的 font-size 值就行了。当设备发生变化的时候，font-size 就会跟着变化，就能实现自动等比适配大小了，从而在不同的设备上表现统一。</p><p>现在我们假设 750px 的设计稿 font-size 为 100px</p><p>其中一个元素的宽度为 200px。</p><p>所以此时 1rem == 100px</p><p>所以此时的元素宽度可以表示为 2rem。</p><p>如果，我现在的设备换到了 375px。换到了新的设备下，它的宽度仍然是 2rem，而新设备下是需要我们需要修改 font-size 的值来让这个 2rem 来适配这个 375px 的设备。</p><p>设计稿宽度 750px font-size：100px</p><p>设计稿元素 200px === 2rem</p><p>新设备的宽度 375px font-size：？px</p><p>得到公式：</p><p>新的 font-size = 设计稿的参照 font-size * （新设备的宽度/设计稿宽度）</p><p>将它转换成 JS：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 设计稿的宽度</span>
<span class="token keyword">const</span> <span class="token constant">PAGE_WIDTH</span> <span class="token operator">=</span> <span class="token number">750</span><span class="token punctuation">;</span>
<span class="token comment">// 设计稿参考的根节点字体大小</span>
<span class="token keyword">const</span> <span class="token constant">PAGE_FONT_SIZE</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment">// 设置根节点字体大小</span>
<span class="token keyword">function</span> <span class="token function">setRootFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span>
		<span class="token constant">PAGE_FONT_SIZE</span> <span class="token operator">*</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth <span class="token operator">/</span> <span class="token constant">PAGE_WIDTH</span><span class="token punctuation">)</span> <span class="token operator">+</span>
		<span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;resize&quot;</span><span class="token punctuation">,</span> setRootFontSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>考虑到 Andorid 端字体渲染的问题以及页面大小变化的监听，最终代码如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
	<span class="token keyword">var</span> <span class="token constant">PAGE_WIDTH</span> <span class="token operator">=</span> <span class="token number">750</span><span class="token punctuation">;</span> <span class="token comment">// 设计稿的宽度</span>
	<span class="token keyword">var</span> <span class="token constant">PAGE_FONT_SIZE</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">// 设计稿1rem的大小</span>

	<span class="token keyword">function</span> <span class="token function">onResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">var</span> e <span class="token operator">=</span>
			<span class="token punctuation">(</span><span class="token constant">PAGE_FONT_SIZE</span> <span class="token operator">*</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth<span class="token punctuation">)</span> <span class="token operator">/</span>
			<span class="token constant">PAGE_WIDTH</span><span class="token punctuation">;</span>
		document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> e <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
		<span class="token comment">// 二次计算缩放像素，解决移动端webkit字体缩放bug</span>
		<span class="token keyword">var</span> realitySize <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>
			window<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">)</span><span class="token punctuation">.</span>fontSize
		<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!==</span> realitySize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			e <span class="token operator">=</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> e<span class="token punctuation">)</span> <span class="token operator">/</span> realitySize<span class="token punctuation">;</span>
			document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> e <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
    <span class="token comment">// 防抖</span>
	window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;resize&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
		timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>onResize<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">onResize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,28),o=[e];function c(i,l){return s(),a("div",null,o)}const r=n(p,[["render",c],["__file","mobile-device-adaptation.html.vue"]]);export{r as default};
